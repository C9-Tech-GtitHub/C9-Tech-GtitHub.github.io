<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Title Structure Analysis Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .controls-section {
            background: #f8f9ff;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.1);
        }
        
        .controls-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .control-group label {
            font-weight: 600;
            color: #667eea;
            font-size: 0.9em;
        }
        
        .date-filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .date-filter-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .date-filter-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }
        
        .date-filter-btn.active {
            background: #667eea;
            color: white;
        }
        
        .custom-date-inputs {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .custom-date-inputs input {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.9em;
        }
        
        .custom-date-inputs input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .filter-info {
            background: #e8f0ff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }
        
        .filter-info.active {
            display: block;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .pattern-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .pattern-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .pattern-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .pattern-table tr:hover {
            background: #f8f9ff;
        }
        
        .performance-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .badge-excellent {
            background: #10b981;
            color: white;
        }
        
        .badge-good {
            background: #3b82f6;
            color: white;
        }
        
        .badge-average {
            background: #f59e0b;
            color: white;
        }
        
        .badge-poor {
            background: #ef4444;
            color: white;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .insights-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .insights-box h3 {
            color: #2d3436;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .insights-box ul {
            list-style: none;
            padding-left: 0;
        }
        
        .insights-box li {
            margin-bottom: 15px;
            padding-left: 30px;
            position: relative;
            color: #2d3436;
            line-height: 1.6;
        }
        
        .insights-box li:before {
            content: "💡";
            position: absolute;
            left: 0;
            font-size: 1.2em;
        }
        
        .recommendation-box {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .recommendation-box h3 {
            color: #2d3436;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .recommendation-box .formula {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .file-upload {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
            text-align: center;
        }
        
        .file-upload input[type="file"] {
            display: none;
        }
        
        .file-upload label {
            display: inline-block;
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .file-upload label:hover {
            background: #764ba2;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 Product Title Structure Analysis</h1>
            <p>Optimizing Product Titles for Maximum Search Performance</p>
        </div>
        
        <div class="content">
            <div class="file-upload">
                <label for="csvFile">
                    📊 Upload Your Product Data CSV
                </label>
                <input type="file" id="csvFile" accept=".csv">
                <p style="margin-top: 10px; color: #666;">Upload a CSV with columns: position, title, Date</p>
            </div>
            
            <div id="loadingMessage" class="loading" style="display: none;">
                Analyzing your data... This may take a moment for large files.
            </div>
            
            <div id="dashboard" style="display: none;">
                <div class="controls-section">
                    <div class="controls-row">
                        <div class="control-group">
                            <label>📅 Date Range Filter</label>
                            <div class="date-filter-buttons">
                                <button class="date-filter-btn active" data-range="all">All Time</button>
                                <button class="date-filter-btn" data-range="year">Last Year</button>
                                <button class="date-filter-btn" data-range="6months">Last 6 Months</button>
                                <button class="date-filter-btn" data-range="3months">Last 3 Months</button>
                                <button class="date-filter-btn" data-range="month">Last Month</button>
                                <button class="date-filter-btn" data-range="week">Last Week</button>
                                <button class="date-filter-btn" data-range="custom">Custom Range</button>
                            </div>
                        </div>
                        
                        <div class="control-group" id="customDateInputs" style="display: none;">
                            <label>Custom Date Range</label>
                            <div class="custom-date-inputs">
                                <input type="date" id="startDate" placeholder="Start Date">
                                <span>to</span>
                                <input type="date" id="endDate" placeholder="End Date">
                                <button class="date-filter-btn" id="applyCustomDate">Apply</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="filter-info" id="filterInfo">
                    <strong>Active Filter:</strong> <span id="filterDescription"></span><br>
                    <strong>Date Range:</strong> <span id="dateRangeDisplay"></span><br>
                    <strong>Products in Range:</strong> <span id="filteredCount"></span> of <span id="totalCount"></span>
                </div>
                
                <div class="section">
                    <h2>📈 Key Metrics</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value" id="totalProducts">-</div>
                            <div class="metric-label">Products in Range</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="avgPosition">-</div>
                            <div class="metric-label">Average Position</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="uniquePatterns">-</div>
                            <div class="metric-label">Unique Patterns</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="bestPattern">-</div>
                            <div class="metric-label">Best Avg Position</div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h2>🏆 Top Performing Title Structures</h2>
                    <div id="topPatternsTable"></div>
                </div>
                
                <div class="section">
                    <h2>📊 Pattern Performance Distribution</h2>
                    <div class="chart-container">
                        <canvas id="patternChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2>📊 Attribute Usage Analysis</h2>
                    <div class="chart-container">
                        <canvas id="attributeChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2>📊 Performance Over Time</h2>
                    <div class="chart-container">
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>
                
                <div class="insights-box">
                    <h3>🔍 Key Insights</h3>
                    <ul id="insightsList"></ul>
                </div>
                
                <div class="recommendation-box">
                    <h3>💡 Recommendations</h3>
                    <div id="recommendations"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Enhanced Pattern definitions with better brand detection and sorting priority
        const patterns = {
            // BRANDS - Comprehensive multi-category brand coverage
            brand: new RegExp(
                '\\b(' +
                // FASHION & CLOTHING BRANDS (Multi-word brands first for better matching)
                'polo\\s*ralph\\s*lauren|tommy\\s*hilfiger|calvin\\s*klein|hugo\\s*boss|' +
                'marc\\s*jacobs|michael\\s*kors|alexander\\s*mcqueen|stella\\s*mccartney|' +
                'vivienne\\s*westwood|jean\\s*paul\\s*gaultier|issey\\s*miyake|' +
                'comme\\s*des\\s*garcons|maison\\s*margiela|acne\\s*studios|' +
                'stone\\s*island|cp\\s*company|off\\s*white|palm\\s*angels|' +
                'golden\\s*goose|common\\s*projects|rick\\s*owens|fear\\s*of\\s*god|' +
                'true\\s*religion|rock\\s*revival|7\\s*for\\s*all\\s*mankind|' +
                'citizens\\s*of\\s*humanity|paige\\s*denim|mother\\s*denim|' +
                'rag\\s*&\\s*bone|current\\s*elliott|diesel\\s*black\\s*gold|' +
                'just\\s*cavalli|roberto\\s*cavalli|dolce\\s*&\\s*gabbana|' +
                'armani\\s*exchange|emporio\\s*armani|giorgio\\s*armani|' +
                'versace\\s*jeans|philipp\\s*plein|balmain\\s*paris|' +
                'saint\\s*laurent|yves\\s*saint\\s*laurent|isabel\\s*marant|' +
                'chloe\\s*see\\s*by|see\\s*by\\s*chloe|tory\\s*burch|' +
                'diane\\s*von\\s*furstenberg|rebecca\\s*minkoff|kate\\s*spade|' +
                
                // AUSTRALIAN FASHION BRANDS
                'cotton\\s*on|brilliant\\s*basics?|kiss\\s*chacey|unit\\s*craft|' +
                'saint\\s*morta|gmaxx\\s*active|supa\\s*pro|common\\s*need|' +
                'imperial\\s*supplements|asos\\s*design|biz\\s*collection|' +
                'article\\s*one|atmos\\s*&\\s*here|rip\\s*curl|bad\\s*boy|' +
                'camilla\\s*&\\s*marc|zimmermann\\s*swim|tigerlily\\s*swim|' +
                'seafolly\\s*australia|bonds\\s*australia|tradie\\s*workwear|' +
                'hard\\s*yakka|king\\s*gee|bisley\\s*workwear|' +
                'assembly\\s*label|st\\s*agni|deiji\\s*studios|alemais\\s*sydney|' +
                'bec\\s*&\\s*bridge|sir\\s*the\\s*label|faithfull\\s*the\\s*brand|' +
                'spell\\s*&\\s*the\\s*gypsy|posse\\s*collective|matteau\\s*swim|' +
                'christopher\\s*esber|dion\\s*lee|romance\\s*was\\s*born|' +
                'aje\\s*australia|bassike\\s*sydney|anna\\s*quan|beare\\s*park|' +
                'double\\s*rainbouu|p\\.?e\\.?\\s*nation|muscle\\s*republic|' +
                'lorna\\s*jane|running\\s*bare|dharma\\s*bums|jaggad\\s*active|' +
                'white\\s*fox\\s*boutique|princess\\s*polly|beginning\\s*boutique|' +
                'showpo\\s*fashion|meshki\\s*australia|sabo\\s*skirt|' +
                'tigermist\\s*fashion|forever\\s*new|tarocash|country\\s*road|' +
                'marc\\s*jacobs|fashion\\s*nova|cupshe\\s*bikini|burkes|' +
                'laura\\s*jones|brunswick|marcs|typo|yilcer|' +
                
                // SINGLE WORD BRANDS (Comprehensive alphabetical list)
                'adidas|afends|afl|aje|alemais|alias|allbirds|almost|alva|ambra|and1|' +
                'anine|anta|antihero|armani|asics|asos|aspire|assembly|atp|aurate|' +
                'aveda|baker|balenciaga|balmain|bassike|bec|berkner|billabong|bisley|' +
                'blind|bonds|boucheron|brooks|brunswick|bulgari|burkes|burberry|' +
                'calvin|camilla|canterbury|cartier|casio|celine|chanel|champion|' +
                'chesty|chopard|citizen|coach|converse|connor|cos|cotton|crocs|' +
                'cult|cupshe|cuyana|deiji|desolve|diesel|dior|dolce|element|everlast|' +
                'fendi|fila|forever|fossil|fourstar|ganni|ghanda|givenchy|globe|' +
                'guess|gucci|gx1000|hallensteins?|hayabusa|hermes|hillbilly|hockey|' +
                'hurley|independent|jacquemus|jb\'?s|jockey|jordan|kappa|khaite|' +
                'kmart|krooked|lacoste|lakai|laura|longchamp|loewe|lorna|lululemon|' +
                'mambo|mansur|marc|marcs|maxx|medal|mejuri|merrell|mikimoto|' +
                'missoma|mizuno|moncler|na-kd|neous|neuw|nike|nrl|oakley|omega|' +
                'onebyone|oroton|palace|pandora|patagonia|piaget|polar|polene|' +
                'powell|prada|puma|quasi|reebok|reef|rejina|rolex|rvca|salomon|' +
                'saucony|sbd|seafolly|seiko|spell|spitfire|sportscraft|staud|' +
                'supreme|swarovski|tapout|tarocash|thunder|tiffany|tigerlily|' +
                'timberland|tommy|toteme|tradie|typo|uniqlo|unit|valentino|vans|' +
                'venroy|venum|versace|volcom|wandler|yd\\.|yilcer|zero|zimmermann' +
                ')\\b', 'i'
            ),
            
            // PRODUCT TYPES - Comprehensive coverage of all categories
            productType: /\b(singlets?|tanks?|tank\s*tops?|vests?|undershirts?|a-shirts?|muscle\s*shirts?|camisoles?|cami|tube\s*tops?|crop\s*tops?|sleeveless|halter\s*tops?|bandeau|bustier|corset|bodice|tees?|t-shirts?|shirts?|tops?|blouses?|tunics?|peplum|kimono|kaftan|wrap\s*tops?|off\s*shoulder|cold\s*shoulder|sweaters?|jumpers?|pullovers?|hoodies?|hooded\s*sweatshirts?|sweatshirts?|cardigans?|knitwear|knits?|turtlenecks?|polo\s*shirts?|button\s*ups?|button\s*downs?|dress\s*shirts?|casual\s*shirts?|formal\s*shirts?|denim\s*shirts?|flannel\s*shirts?|jackets?|blazers?|coats?|parkas?|bombers?|denim\s*jackets?|leather\s*jackets?|windbreakers?|raincoats?|trench\s*coats?|peacoats?|puffer\s*jackets?|down\s*jackets?|ski\s*jackets?|moto\s*jackets?|varsity\s*jackets?|track\s*jackets?|dresses?|maxi\s*dresses?|midi\s*dresses?|mini\s*dresses?|shift\s*dresses?|wrap\s*dresses?|bodycon\s*dresses?|a-line\s*dresses?|fit\s*and\s*flare|sheath\s*dresses?|slip\s*dresses?|shirt\s*dresses?|sweater\s*dresses?|cocktail\s*dresses?|evening\s*gowns?|ball\s*gowns?|prom\s*dresses?|wedding\s*dresses?|bridesmaid\s*dresses?|playsuits?|rompers?|jumpsuits?|overalls?|dungarees?|swimwear|swimsuits?|bikinis?|bikini\s*sets?|one\s*pieces?|two\s*pieces?|monokinis?|tankinis?|swim\s*tops?|swim\s*bottoms?|board\s*shorts?|rash\s*guards?|cover\s*ups?|sarongs?|skirts?|mini\s*skirts?|maxi\s*skirts?|midi\s*skirts?|a-line\s*skirts?|pencil\s*skirts?|pleated\s*skirts?|circle\s*skirts?|wrap\s*skirts?|denim\s*skirts?|leather\s*skirts?|shorts?|bermuda\s*shorts?|cargo\s*shorts?|denim\s*shorts?|athletic\s*shorts?|running\s*shorts?|board\s*shorts?|chino\s*shorts?|bike\s*shorts?|hot\s*pants|jeans?|skinny\s*jeans?|straight\s*jeans?|bootcut\s*jeans?|flare\s*jeans?|wide\s*leg\s*jeans?|boyfriend\s*jeans?|mom\s*jeans?|high\s*waisted\s*jeans?|low\s*rise\s*jeans?|ripped\s*jeans?|distressed\s*jeans?|raw\s*denim|selvedge\s*denim|pants?|trousers?|chinos?|khakis?|dress\s*pants?|cargo\s*pants?|joggers?|sweatpants?|trackies?|track\s*pants?|leggings?|yoga\s*pants?|athletic\s*pants?|palazzo\s*pants?|wide\s*leg\s*pants?|culottes?|capris?|jewelry|jewellery|necklaces?|pendants?|chains?|chokers?|lockets?|earrings?|studs?|hoops?|dangles?|chandeliers?|climbers?|ear\s*cuffs?|bracelets?|bangles?|cuffs?|tennis\s*bracelets?|charm\s*bracelets?|rings?|engagement\s*rings?|wedding\s*bands?|cocktail\s*rings?|statement\s*rings?|stackable\s*rings?|promise\s*rings?|signet\s*rings?|watches?|timepieces?|chronographs?|dress\s*watches?|sport\s*watches?|smart\s*watches?|digital\s*watches?|analog\s*watches?|brooches?|pins?|cufflinks?|tie\s*clips?|tie\s*bars?|footwear|shoes?|sneakers?|trainers?|runners?|athletic\s*shoes?|running\s*shoes?|basketball\s*shoes?|tennis\s*shoes?|cross\s*trainers?|walking\s*shoes?|hiking\s*boots?|work\s*boots?|combat\s*boots?|chelsea\s*boots?|ankle\s*boots?|knee\s*high\s*boots?|thigh\s*high\s*boots?|cowboy\s*boots?|rain\s*boots?|snow\s*boots?|dress\s*shoes?|oxford\s*shoes?|loafers?|moccasins?|boat\s*shoes?|driving\s*shoes?|pumps?|heels?|stilettos?|wedges?|platforms?|flats?|ballet\s*flats?|sandals?|flip\s*flops?|slides?|mules?|clogs?|espadrilles?|hats?|caps?|beanies?|berets?|fedoras?|baseball\s*caps?|snapbacks?|bucket\s*hats?|sun\s*hats?|visors?|headbands?|hair\s*accessories?|hair\s*clips?|hair\s*bands?|scrunchies?|hair\s*ties?|bobby\s*pins?|barrettes?|hair\s*combs?|headwraps?|turbans?|sunglasses?|shades?|eyewear|aviators?|wayfarers?|cat\s*eyes?|oversized\s*sunglasses?|round\s*sunglasses?|square\s*sunglasses?|sport\s*sunglasses?|polarized\s*sunglasses?|bags?|handbags?|purses?|totes?|tote\s*bags?|shoulder\s*bags?|crossbody\s*bags?|cross\s*body\s*bags?|satchels?|hobo\s*bags?|clutches?|clutch\s*bags?|evening\s*bags?|backpacks?|rucksacks?|messenger\s*bags?|laptop\s*bags?|gym\s*bags?|duffel\s*bags?|travel\s*bags?|weekender\s*bags?|camera\s*bags?|fanny\s*packs?|belt\s*bags?|wallets?|coin\s*purses?|card\s*holders?|money\s*clips?|top\s*handle\s*bags?|zip\s*top\s*bags?|lock\s*bags?|slouch\s*bags?|mini\s*bags?|micro\s*bags?|oversized\s*bags?|bucket\s*bags?|drawstring\s*bags?|structured\s*bags?|soft\s*bags?|leather\s*bags?|canvas\s*bags?|nylon\s*bags?|designer\s*bags?|luxury\s*bags?|skateboards?|longboards?|cruiser\s*boards?|penny\s*boards?|complete\s*skateboards?|skateboard\s*decks?|skateboard\s*trucks?|skateboard\s*wheels?|skateboard\s*bearings?|grip\s*tape?|skateboard\s*hardware?|skateboard\s*tools?)\b/i,
            
            gender: /\b(mens?|men\'?s?|womens?|women\'?s?|ladies|lady\'?s?|girls?|boys?|unisex|kids?|childrens?|junior|youth|toddlers?|infants?|baby|maternity|plus\s*size|petite|tall)\b/i,
            
            // Enhanced size patterns for all product types
            size: /\b(xs|x-small|small|medium|large|x-large|xl|xxl|xxx-large|2xl|3xl|4xl|5xl|plus\s*size|petite|tall|regular|one\s*size|free\s*size|os|adjustable|0|2|4|6|8|10|12|14|16|18|20|22|24|26|28|30|32|34|36|38|40|42|44|46|48|50|52|54|56|58|60|62|64|66|68|70|72|74|76|78|80|82|84|86|88|90|92|94|96|98|100|102|104|106|108|110|112|114|116|118|120|3\.5|4|4\.5|5|5\.5|6|6\.5|7|7\.5|8|8\.5|9|9\.5|10|10\.5|11|11\.5|12|12\.5|13|13\.5|14|14\.5|15|15\.5|16|eu\s*35|eu\s*36|eu\s*37|eu\s*38|eu\s*39|eu\s*40|eu\s*41|eu\s*42|eu\s*43|eu\s*44|eu\s*45|eu\s*46|eu\s*47|eu\s*48|eu\s*49|eu\s*50|uk\s*3|uk\s*4|uk\s*5|uk\s*6|uk\s*7|uk\s*8|uk\s*9|uk\s*10|uk\s*11|uk\s*12|uk\s*13|us\s*4|us\s*5|us\s*6|us\s*7|us\s*8|us\s*9|us\s*10|us\s*11|us\s*12|us\s*13|us\s*14|cup\s*a|cup\s*b|cup\s*c|cup\s*d|cup\s*dd|cup\s*e|cup\s*f|cup\s*g|32a|32b|32c|32d|34a|34b|34c|34d|34dd|36a|36b|36c|36d|36dd|38a|38b|38c|38d|38dd|40a|40b|40c|40d|40dd|42a|42b|42c|42d|42dd|waist\s*24|waist\s*25|waist\s*26|waist\s*27|waist\s*28|waist\s*29|waist\s*30|waist\s*31|waist\s*32|waist\s*33|waist\s*34|waist\s*35|waist\s*36|waist\s*37|waist\s*38|waist\s*39|waist\s*40|waist\s*42|waist\s*44|waist\s*46|waist\s*48|waist\s*50|7\.25|7\.5|7\.75|8|8\.25|8\.5|8\.75|9|9\.25|9\.5|9\.75|10|10\.25|10\.5|10\.75|11|11\.25|11\.5|11\.75|12|12\.25|12\.5|12\.75|13|13\.25|13\.5|13\.75|14)\b/i,
            
            // Comprehensive activity patterns
            activity: /\b(wrestling|powerlifting|training|running|athletic|sports?|gym|fitness|workout|exercise|yoga|pilates|crossfit|boxing|mma|martial\s*arts|basketball|football|soccer|tennis|golf|swimming|cycling|hiking|climbing|skiing|snowboarding|surfing|skateboarding|bodybuilding|weightlifting|jogging|cardio|aerobic|strength|endurance|performance|competition|racing|triathlon|marathon|half\s*marathon|5k|10k|ultra\s*marathon|trail\s*running|obstacle\s*course|spartan\s*race|tough\s*mudder|crossfit\s*games|olympic\s*lifting|powerlifting|strongman|calisthenics|street\s*workout|parkour|freerunning|rock\s*climbing|bouldering|mountaineering|alpinism|ice\s*climbing|rappelling|abseiling|base\s*jumping|skydiving|paragliding|hang\s*gliding|windsurfing|kitesurfing|paddleboarding|sup|stand\s*up\s*paddle|kayaking|canoeing|rafting|rowing|sailing|yachting|fishing|angling|fly\s*fishing|deep\s*sea\s*fishing|spearfishing|freediving|scuba\s*diving|snorkeling|water\s*polo|synchronized\s*swimming|diving|springboard|platform|beach\s*volleyball|volleyball|badminton|squash|racquetball|ping\s*pong|table\s*tennis|cricket|rugby|american\s*football|aussie\s*rules|netball|handball|water\s*basketball|lacrosse|field\s*hockey|ice\s*hockey|roller\s*hockey|inline\s*skating|roller\s*skating|ice\s*skating|figure\s*skating|speed\s*skating|bmx|mountain\s*biking|road\s*cycling|track\s*cycling|cyclocross|gravel\s*biking|electric\s*biking|e\s*bike|motocross|motorcycling|atv|quad\s*biking|dirt\s*biking|supercross|freestyle\s*motocross|rallying|karting|go\s*karting|formula\s*racing|nascar|drag\s*racing|drifting|autocross|rallycross|offroad\s*racing|desert\s*racing|mud\s*racing|monster\s*truck|equestrian|horse\s*riding|dressage|show\s*jumping|eventing|polo|rodeo|barrel\s*racing|archery|target\s*shooting|clay\s*pigeon|trap\s*shooting|skeet\s*shooting|hunting|bow\s*hunting|rifle\s*shooting|pistol\s*shooting|biathlon|modern\s*pentathlon|decathlon|heptathlon|track\s*and\s*field|athletics|sprinting|middle\s*distance|long\s*distance|hurdles|steeplechase|relay|high\s*jump|long\s*jump|triple\s*jump|pole\s*vault|shot\s*put|discus|hammer\s*throw|javelin|walking|race\s*walking|orienteering|adventure\s*racing|multi\s*sport|duathlon|aquathlon|swimrun|ironman|70\.3|olympic\s*distance|sprint\s*distance|super\s*sprint|long\s*course|short\s*course|open\s*water|pool\s*swimming|masters\s*swimming|age\s*group|elite|professional|amateur|recreational|leisure|casual|lifestyle|everyday|street|urban|outdoor|indoor|winter\s*sports|summer\s*sports|water\s*sports|extreme\s*sports|action\s*sports|board\s*sports|combat\s*sports|racquet\s*sports|ball\s*sports|team\s*sports|individual\s*sports|endurance\s*sports|strength\s*sports|speed\s*sports|precision\s*sports|mind\s*sports|esports|gaming|virtual\s*reality|vr|active\s*recovery|foam\s*rolling|stretching|mobility|rehabilitation|physiotherapy|injury\s*prevention|performance\s*enhancement|sports\s*nutrition|hydration|pre\s*workout|post\s*workout|recovery|rest\s*day|active\s*rest|cross\s*training|periodization|base\s*building|peaking|tapering|off\s*season|preseason|in\s*season|competition\s*season|training\s*camp|boot\s*camp|group\s*fitness|personal\s*training|coaching|sports\s*science|biomechanics|kinesiology|exercise\s*physiology|sports\s*psychology|mental\s*training|visualization|meditation|mindfulness)\b/i,
            
            // Comprehensive material patterns
            material: /\b(100%\s*cotton|cotton|organic\s*cotton|pima\s*cotton|supima\s*cotton|egyptian\s*cotton|bamboo\s*cotton|recycled\s*cotton|sustainable\s*cotton|fair\s*trade\s*cotton|gots\s*certified|oeko\s*tex|polyester|poly|recycled\s*polyester|rpet|polyester\s*blend|poly\s*cotton|cotton\s*poly|polycotton|nylon|polyamide|recycled\s*nylon|econyl|spandex|elastane|lycra|stretch|flex|bi\s*stretch|4\s*way\s*stretch|2\s*way\s*stretch|stretch\s*cotton|stretch\s*denim|power\s*stretch|compression|performance\s*stretch|modal|micro\s*modal|beechwood\s*modal|tencel|lyocell|eucalyptus\s*fiber|banana\s*fiber|hemp|organic\s*hemp|linen|irish\s*linen|european\s*linen|belgian\s*linen|french\s*linen|flax\s*linen|ramie|jute|burlap|hessian|canvas|duck\s*canvas|heavyweight\s*canvas|organic\s*canvas|waxed\s*canvas|oil\s*cloth|denim|raw\s*denim|selvedge\s*denim|selvage\s*denim|indigo\s*denim|stone\s*washed\s*denim|acid\s*washed\s*denim|distressed\s*denim|vintage\s*denim|premium\s*denim|japanese\s*denim|turkey\s*denim|cone\s*mills\s*denim|white\s*oak\s*denim|kuroki\s*mills|kaihara\s*mills|collect\s*mills|nihon\s*menpu|silk|mulberry\s*silk|peace\s*silk|ahimsa\s*silk|tussah\s*silk|wild\s*silk|dupioni\s*silk|charmeuse\s*silk|chiffon\s*silk|crepe\s*de\s*chine|georgette\s*silk|habotai\s*silk|jersey\s*silk|noil\s*silk|organza\s*silk|satin\s*silk|shantung\s*silk|taffeta\s*silk|wool|merino\s*wool|lambswool|cashmere|pashmina|angora|mohair|alpaca|vicuna|camel\s*hair|yak\s*wool|qiviut|sheep\s*wool|virgin\s*wool|new\s*wool|recycled\s*wool|felt|boiled\s*wool|tweed|harris\s*tweed|donegal\s*tweed|shetland\s*wool|aran\s*wool|fisherman\s*wool|chunky\s*knit|cable\s*knit|fair\s*isle|intarsia|jacquard\s*knit|rib\s*knit|waffle\s*knit|honeycomb\s*knit|seed\s*stitch|moss\s*stitch|garter\s*stitch|stockinette|jersey\s*knit|interlock\s*knit|french\s*terry|fleece|polar\s*fleece|micro\s*fleece|sherpa\s*fleece|berber\s*fleece|coral\s*fleece|anti\s*pill\s*fleece|brushed\s*fleece|synthetic\s*fleece|eco\s*fleece|recycled\s*fleece|velour|velvet|crushed\s*velvet|burnout\s*velvet|stretch\s*velvet|silk\s*velvet|cotton\s*velvet|polyester\s*velvet|corduroy|wide\s*wale\s*corduroy|narrow\s*wale\s*corduroy|baby\s*corduroy|stretch\s*corduroy|pinwale\s*corduroy|needlecord|suede|faux\s*suede|microsuede|ultrasuede|synthetic\s*suede|vegan\s*suede|leather|genuine\s*leather|full\s*grain\s*leather|top\s*grain\s*leather|corrected\s*grain\s*leather|split\s*leather|bonded\s*leather|patent\s*leather|nappa\s*leather|nubuck\s*leather|distressed\s*leather|vintage\s*leather|oil\s*tanned\s*leather|vegetable\s*tanned\s*leather|chrome\s*tanned\s*leather|eco\s*leather|recycled\s*leather|vegan\s*leather|faux\s*leather|pleather|pu\s*leather|synthetic\s*leather|microfiber|ultra\s*microfiber|performance\s*microfiber|chamois|synthetic\s*chamois|polyurethane|pu|tpu|thermoplastic\s*polyurethane|eva|ethylene\s*vinyl\s*acetate|memory\s*foam|gel\s*foam|latex|natural\s*latex|synthetic\s*latex|neoprene|chloroprene\s*rubber|sbr|nitrile\s*rubber|epdm|silicone|rubber|natural\s*rubber|synthetic\s*rubber|vulcanized\s*rubber|crumb\s*rubber|recycled\s*rubber|mesh|air\s*mesh|3d\s*mesh|spacer\s*mesh|athletic\s*mesh|power\s*mesh|stretch\s*mesh|open\s*mesh|closed\s*mesh|knit\s*mesh|woven\s*mesh|monofilament\s*mesh|multifilament\s*mesh|lace|stretch\s*lace|floral\s*lace|geometric\s*lace|eyelash\s*lace|scalloped\s*lace|venice\s*lace|chantilly\s*lace|alencon\s*lace|guipure\s*lace|corded\s*lace|embroidered\s*lace|beaded\s*lace|sequined\s*lace|metallic\s*lace|tulle|soft\s*tulle|stiff\s*tulle|glitter\s*tulle|metallic\s*tulle|illusion\s*tulle|english\s*net|point\s*d\s*esprit|organza|silk\s*organza|polyester\s*organza|crystal\s*organza|mirror\s*organza|iridescent\s*organza|chiffon|silk\s*chiffon|polyester\s*chiffon|georgette\s*chiffon|crinkle\s*chiffon|crepe|crepe\s*de\s*chine|wool\s*crepe|silk\s*crepe|polyester\s*crepe|stretch\s*crepe|morocain\s*crepe|canton\s*crepe|satin|duchess\s*satin|charmeuse\s*satin|stretch\s*satin|matte\s*satin|polyester\s*satin|silk\s*satin|bridal\s*satin|lamé|metallic\s*lamé|lurex|metallic\s*thread|gold\s*thread|silver\s*thread|copper\s*thread|sequin|sequined\s*fabric|holographic\s*sequin|matte\s*sequin|iridescent\s*sequin|cup\s*sequin|flat\s*sequin|beaded\s*fabric|seed\s*bead|bugle\s*bead|crystal\s*bead|pearl\s*bead|metallic\s*bead|glass\s*bead|rhinestone|crystal\s*rhinestone|acrylic\s*rhinestone|hotfix\s*rhinestone|sew\s*on\s*rhinestone|studs|metal\s*studs|plastic\s*studs|pyramid\s*studs|cone\s*studs|round\s*studs|square\s*studs|star\s*studs|grommets|eyelets|rivets|snaps|hooks|eyes|zippers|invisible\s*zipper|separating\s*zipper|non\s*separating\s*zipper|coil\s*zipper|metal\s*zipper|plastic\s*zipper|waterproof\s*zipper|buttons|metal\s*buttons|plastic\s*buttons|wood\s*buttons|shell\s*buttons|horn\s*buttons|coconut\s*buttons|mother\s*of\s*pearl\s*buttons|covered\s*buttons|shank\s*buttons|flat\s*buttons|toggle\s*buttons|velcro|hook\s*and\s*loop|adhesive\s*velcro|sew\s*on\s*velcro|elastic|fold\s*over\s*elastic|braided\s*elastic|knit\s*elastic|woven\s*elastic|clear\s*elastic|black\s*elastic|white\s*elastic|colored\s*elastic|reflective\s*elastic|bias\s*tape|single\s*fold\s*bias\s*tape|double\s*fold\s*bias\s*tape|stretch\s*bias\s*tape|cotton\s*bias\s*tape|polyester\s*bias\s*tape|satin\s*bias\s*tape|grosgrain\s*ribbon|satin\s*ribbon|velvet\s*ribbon|sheer\s*ribbon|wire\s*edge\s*ribbon|picot\s*edge\s*ribbon|jacquard\s*ribbon|metallic\s*ribbon|reflective\s*ribbon|printed\s*ribbon|solid\s*ribbon|striped\s*ribbon|polka\s*dot\s*ribbon|floral\s*ribbon|geometric\s*ribbon|holiday\s*ribbon|seasonal\s*ribbon|trim|fringe|tassel\s*fringe|ball\s*fringe|loop\s*fringe|brush\s*fringe|chainette\s*fringe|cut\s*fringe|bullion\s*fringe|gimp\s*trim|cord\s*trim|braided\s*trim|flat\s*trim|piping|welting|corded\s*piping|bias\s*piping|contrast\s*piping|self\s*piping|rickrack|jumbo\s*rickrack|baby\s*rickrack|medium\s*rickrack|pom\s*pom|pom\s*pom\s*trim|ball\s*trim|bobble\s*trim|tassel|tassel\s*trim|beaded\s*trim|sequined\s*trim|metallic\s*trim|feather\s*trim|fur\s*trim|faux\s*fur\s*trim|marabou\s*trim|ostrich\s*feather\s*trim|peacock\s*feather\s*trim|rooster\s*feather\s*trim|goose\s*feather\s*trim|duck\s*feather\s*trim|down|goose\s*down|duck\s*down|synthetic\s*down|alternative\s*down|eco\s*down|recycled\s*down|responsibly\s*sourced\s*down|rds\s*certified|traceable\s*down|ethically\s*sourced|sustainably\s*sourced|certified\s*organic|gots|oeko\s*tex\s*standard|bluesign|cradle\s*to\s*cradle|better\s*cotton\s*initiative|bci|recycled\s*content|post\s*consumer\s*recycled|post\s*industrial\s*recycled|bio\s*based|biodegradable|compostable|renewable|circular|closed\s*loop|zero\s*waste|carbon\s*neutral|carbon\s*negative|low\s*impact|eco\s*friendly|environmentally\s*friendly|green|sustainable|conscious|ethical|fair\s*trade|conflict\s*free|cruelty\s*free|vegan|plant\s*based|animal\s*free|mulesing\s*free|chemical\s*free|non\s*toxic|hypoallergenic|antimicrobial|antibacterial|antifungal|anti\s*odor|odor\s*resistant|stain\s*resistant|water\s*resistant|water\s*repellent|waterproof|breathable|moisture\s*wicking|quick\s*dry|fast\s*dry|dry\s*fit|coolmax|thermocool|climacool|dri\s*fit|dri\s*release|freshguard|polygiene|silvadur|ionic|copper\s*infused|bamboo\s*charcoal|activated\s*charcoal|aloe\s*vera\s*infused|vitamin\s*e\s*infused|caffeine\s*infused|retinol\s*infused|ceramide\s*infused|collagen\s*infused|compression|graduated\s*compression|medical\s*compression|athletic\s*compression|recovery\s*compression|15\s*20\s*mmhg|20\s*30\s*mmhg|30\s*40\s*mmhg|thermal|insulating|heat\s*retention|cold\s*weather|warm\s*weather|all\s*season|mid\s*season|transitional|layering|base\s*layer|mid\s*layer|outer\s*layer|shell\s*layer|soft\s*shell|hard\s*shell|windproof|wind\s*resistant|weatherproof|weather\s*resistant|storm\s*proof|arctic|alpine|expedition|technical|performance|high\s*performance|professional|commercial|industrial|military\s*spec|tactical|outdoor|hiking|camping|backpacking|mountaineering|climbing|skiing|snowboarding|surfing|diving|sailing|fishing|hunting|shooting|archery|equestrian|motorcycle|automotive|aviation|aerospace|medical|healthcare|laboratory|cleanroom|food\s*service|hospitality|uniform|workwear|safety|hi\s*vis|high\s*visibility|reflective|flame\s*resistant|fire\s*retardant|arc\s*rated|cut\s*resistant|puncture\s*resistant|tear\s*resistant|rip\s*stop|ballistic|kevlar|nomex|cordura|dyneema|spectra|vectran|zylon|carbon\s*fiber|fiberglass|ceramic|titanium|aluminum|steel|stainless\s*steel|brass|copper|bronze|silver|gold|platinum|palladium|rhodium|iridium|osmium|ruthenium|nickel|chromium|zinc|tin|lead|iron|cobalt|manganese|magnesium|calcium|sodium|potassium|lithium|beryllium|boron|silicon|phosphorus|sulfur|chlorine|fluorine|bromine|iodine|helium|neon|argon|krypton|xenon|radon|hydrogen|deuterium|tritium|carbon|nitrogen|oxygen|ozone)\b/i,
            
            // Comprehensive style patterns
            style: /\b(classic|basic|essential|premium|deluxe|luxury|vintage|retro|modern|contemporary|traditional|casual|formal|smart|relaxed|fitted|slim|skinny|regular|loose|oversized|longline|cropped|reversible|solid|plain|muscle|wide\s*strap|razor|chesty|authentic|craft|marauder|stringer|react|squared\s*neck|scoop\s*neck|v-neck|crew\s*neck|beater|full\s*back|boardmaker|y\s*back|tempo|interval|foundation|seamfree|reflect|momentum|forge|ribbed?|rib|textured|smooth|matte|glossy|shiny|sparkly|glittery|metallic|iridescent|holographic|ombre|gradient|tie\s*dye|batik|paisley|floral|botanical|tropical|abstract|geometric|striped|polka\s*dot|checked|plaid|tartan|houndstooth|herringbone|tweed|cable\s*knit|fisherman|aran|fair\s*isle|nordic|scandinavian|bohemian|boho|hippie|gypsy|ethnic|tribal|aztec|navajo|southwestern|western|cowboy|country|rustic|farmhouse|cottage|shabby\s*chic|french\s*country|parisian|italian|spanish|greek|mediterranean|moroccan|indian|asian|japanese|chinese|korean|thai|vietnamese|indonesian|african|egyptian|turkish|russian|brazilian|mexican|peruvian|colombian|argentinian|chilean|australian|new\s*zealand|british|irish|scottish|welsh|german|dutch|belgian|swiss|austrian|czech|polish|hungarian|romanian|bulgarian|croatian|serbian|slovenian|slovakian|lithuanian|latvian|estonian|finnish|norwegian|swedish|danish|icelandic|portuguese|spanish|catalan|basque|galician|andalusian|valencian|balearic|canarian|madeira|azores|cape\s*verdean|guinean|senegalese|malian|burkinabe|nigerien|chadian|sudanese|south\s*sudanese|ethiopian|eritrean|djiboutian|somalian|kenyan|ugandan|tanzanian|rwandan|burundian|congolese|angolan|zambian|malawian|mozambican|zimbabwean|botswanan|namibian|south\s*african|lesotho|swaziland|madagascar|mauritian|seychellois|comoran|mayotte|reunion|rodrigues|saint\s*helena|ascension|tristan\s*da\s*cunha|falkland|south\s*georgia|south\s*sandwich|antarctic|arctic|polar|sub\s*arctic|temperate|subtropical|tropical|equatorial|mediterranean|continental|oceanic|maritime|desert|arid|semi\s*arid|steppe|savanna|grassland|prairie|tundra|taiga|boreal|deciduous|coniferous|mixed|rainforest|cloud\s*forest|montane|alpine|subalpine|coastal|marine|freshwater|brackish|estuarine|riverine|lacustrine|wetland|marsh|swamp|bog|fen|peatland|moor|heath|scrubland|chaparral|woodland|parkland|urban|suburban|rural|wilderness|backcountry|frontcountry|developed|undeveloped|pristine|natural|artificial|synthetic|manmade|handmade|artisan|crafted|bespoke|custom|tailored|couture|haute\s*couture|ready\s*to\s*wear|off\s*the\s*rack|mass\s*produced|limited\s*edition|exclusive|one\s*of\s*a\s*kind|unique|rare|collectible|vintage|antique|heirloom|heritage|legacy|iconic|legendary|famous|renowned|celebrated|award\s*winning|bestselling|popular|trending|fashionable|stylish|chic|elegant|sophisticated|refined|polished|sleek|streamlined|minimalist|maximalist|ornate|elaborate|detailed|intricate|complex|simple|clean|crisp|sharp|soft|flowing|draped|structured|tailored|constructed|architectural|geometric|organic|fluid|dynamic|static|bold|subtle|understated|statement|eye\s*catching|attention\s*grabbing|standout|striking|dramatic|theatrical|edgy|punk|goth|emo|grunge|alternative|indie|hipster|artsy|creative|artistic|expressive|unique|quirky|whimsical|playful|fun|cute|sweet|romantic|feminine|masculine|androgynous|gender\s*neutral|sporty|athletic|active|performance|technical|functional|practical|utilitarian|industrial|military|tactical|outdoor|rugged|durable|sturdy|robust|strong|tough|heavy\s*duty|commercial|professional|business|office|work|formal|dress|cocktail|evening|party|special\s*occasion|wedding|bridal|bridesmaid|prom|homecoming|graduation|anniversary|birthday|holiday|seasonal|summer|spring|fall|autumn|winter|christmas|new\s*year|valentine|easter|halloween|thanksgiving|fourth\s*of\s*july|memorial\s*day|labor\s*day|back\s*to\s*school|vacation|travel|beach|pool|resort|cruise|tropical|island|surf|skate|street|urban|city|metropolitan|cosmopolitan|international|global|worldwide|universal|timeless|eternal|enduring|lasting|permanent|temporary|seasonal|transitional|emerging|evolving|changing|transforming|adapting|versatile|adaptable|flexible|adjustable|customizable|modular|convertible|reversible|two\s*in\s*one|multi\s*way|multi\s*functional|multi\s*purpose|all\s*in\s*one|combination|hybrid|fusion|blend|mix|match|coordinate|complement|contrast|pop\s*of\s*color|neutral|earth\s*tone|jewel\s*tone|pastel|neon|bright|vibrant|bold|rich|deep|dark|light|pale|soft|muted|subdued|toned\s*down|washed\s*out|faded|distressed|worn|weathered|aged|patina|rust|oxidized|tarnished|burnished|polished|buffed|brushed|sandblasted|etched|engraved|embossed|debossed|raised|recessed|textured|smooth|rough|coarse|fine|delicate|fragile|robust|sturdy|solid|hollow|dense|lightweight|heavy|thick|thin|sheer|opaque|transparent|translucent|clear|frosted|cloudy|hazy|smoky|crystalline|glassy|reflective|non\s*reflective|absorptive|radiant|luminous|glowing|fluorescent|phosphorescent|bioluminescent|incandescent|led|neon|halogen|xenon|laser|fiber\s*optic|electric|electronic|digital|analog|mechanical|manual|automatic|programmable|smart|intelligent|intuitive|user\s*friendly|ergonomic|comfortable|cozy|snug|tight|loose|roomy|spacious|compact|portable|travel\s*friendly|packable|foldable|collapsible|expandable|stretchable|elastic|flexible|rigid|stiff|firm|soft|plush|cushioned|padded|quilted|tufted|buttoned|zippered|velcro|magnetic|adhesive|removable|detachable|interchangeable|replaceable|washable|machine\s*washable|hand\s*wash|dry\s*clean\s*only|care\s*free|low\s*maintenance|easy\s*care|wrinkle\s*free|wrinkle\s*resistant|iron\s*free|no\s*iron|permanent\s*press|wash\s*and\s*wear|tumble\s*dry|air\s*dry|line\s*dry|flat\s*dry|do\s*not\s*bleach|bleach\s*safe|color\s*safe|fade\s*resistant|shrink\s*resistant|pill\s*resistant|snag\s*resistant|run\s*resistant|ladder\s*resistant|shape\s*retaining|form\s*fitting|body\s*hugging|figure\s*flattering|slimming|sculpting|shaping|contouring|enhancing|supporting|lifting|pushing\s*up|minimizing|smoothing|tucking|cinching|nipping|gathering|ruching|shirring|smocking|pleating|draping|cascading|flowing|swirling|twirling|spinning|dancing|moving|active|dynamic|energetic|vibrant|lively|spirited|animated|enthusiastic|passionate|intense|powerful|strong|confident|bold|brave|fearless|daring|adventurous|exploratory|experimental|innovative|creative|original|fresh|new|novel|cutting\s*edge|state\s*of\s*the\s*art|advanced|high\s*tech|futuristic|space\s*age|modern|contemporary|current|up\s*to\s*date|trendy|fashionable|stylish|chic|hip|cool|awesome|amazing|incredible|fantastic|wonderful|beautiful|gorgeous|stunning|breathtaking|spectacular|magnificent|majestic|grand|impressive|remarkable|extraordinary|exceptional|outstanding|superior|excellent|perfect|flawless|impeccable|pristine|immaculate|spotless|clean|fresh|crisp|sharp|clear|bright|brilliant|radiant|glowing|shining|sparkling|glittering|twinkling|shimmering|glistening|gleaming|lustrous|glossy|polished|refined|sophisticated|elegant|graceful|delicate|dainty|petite|fine|exquisite|precious|valuable|priceless|invaluable|treasured|cherished|beloved|adored|worshipped|revered|respected|admired|appreciated|loved|desired|wanted|needed|essential|necessary|important|significant|meaningful|purposeful|useful|beneficial|helpful|advantageous|favorable|positive|good|great|excellent|amazing|wonderful|fantastic|incredible|awesome|outstanding|exceptional|extraordinary|remarkable|impressive|magnificent|majestic|grand|spectacular|breathtaking|stunning|gorgeous|beautiful|slouch|tala|poppy|flag|ava|nero|barbados|recycled|pile\s*lined|full\s*zip|super\s*soft|sleeveless|crochet|sportswear|club|distressed|top\s*handle|zip\s*top|lock\s*bag|multi\s*pocket|embossed|linen|albany|noelle|heart\s*print)\b/i,
            
            // Comprehensive color patterns
            color: /\b(black|white|grey|gray|iron\s*grey|charcoal|slate|steel|pewter|silver|platinum|titanium|gunmetal|anthracite|ebony|onyx|jet\s*black|coal\s*black|midnight|shadow|dark\s*gray|medium\s*gray|light\s*gray|ash|dove\s*gray|pearl\s*gray|smoke|fog|mist|cloud|snow\s*white|ivory|cream|vanilla|eggshell|bone|linen|natural|off\s*white|antique\s*white|warm\s*white|cool\s*white|pure\s*white|bright\s*white|red|crimson|scarlet|ruby|cherry|fire\s*engine\s*red|brick\s*red|burgundy|wine|claret|maroon|oxblood|cardinal|rose|pink|hot\s*pink|fuchsia|magenta|cerise|coral|salmon|peach|blush|dusty\s*rose|mauve|lavender\s*pink|baby\s*pink|powder\s*pink|bubblegum\s*pink|cotton\s*candy|flamingo|orange|tangerine|mandarin|burnt\s*orange|rust|copper|bronze|amber|apricot|papaya|cantaloupe|persimmon|pumpkin|carrot|tiger\s*orange|safety\s*orange|hunter\s*orange|neon\s*orange|yellow|lemon|canary|banana|butter|cream|gold|mustard|honey|amber|saffron|turmeric|marigold|sunflower|school\s*bus\s*yellow|taxi\s*yellow|neon\s*yellow|lime\s*yellow|chartreuse|green|lime|forest\s*green|hunter\s*green|emerald|jade|mint|sage|olive|khaki|army\s*green|military\s*green|pine|evergreen|moss|fern|grass\s*green|kelly\s*green|irish\s*green|shamrock|clover|seafoam|aqua\s*green|turquoise\s*green|teal\s*green|jungle\s*green|bottle\s*green|racing\s*green|british\s*racing\s*green|neon\s*green|electric\s*green|lime\s*green|spring\s*green|blue|navy|royal\s*blue|cobalt|electric\s*blue|sky\s*blue|baby\s*blue|powder\s*blue|light\s*blue|pale\s*blue|ice\s*blue|steel\s*blue|slate\s*blue|denim|indigo|midnight\s*blue|dark\s*blue|deep\s*blue|ocean\s*blue|sea\s*blue|marine\s*blue|nautical\s*blue|pacific\s*blue|atlantic\s*blue|caribbean\s*blue|mediterranean\s*blue|azure|cerulean|sapphire|lapis|periwinkle|cornflower|duck\s*egg\s*blue|robin\s*egg\s*blue|powder\s*blue|columbia\s*blue|carolina\s*blue|yale\s*blue|harvard\s*crimson|princeton\s*orange|cornell\s*red|dartmouth\s*green|brown\s*university|penn\s*red|purple|violet|lavender|lilac|plum|eggplant|aubergine|grape|wine|burgundy|mulberry|orchid|amethyst|royal\s*purple|deep\s*purple|dark\s*purple|light\s*purple|pale\s*purple|pastel\s*purple|mauve|magenta|fuchsia|hot\s*pink|electric\s*purple|neon\s*purple|brown|tan|beige|taupe|camel|sand|desert|khaki|coffee|chocolate|espresso|mocha|cocoa|cinnamon|ginger|nutmeg|walnut|chestnut|mahogany|sienna|umber|burnt\s*sienna|raw\s*sienna|burnt\s*umber|raw\s*umber|sepia|saddle\s*brown|leather\s*brown|cognac|whiskey|bourbon|brandy|caramel|toffee|butterscotch|honey|amber|gold|rose\s*gold|white\s*gold|yellow\s*gold|platinum|silver|copper|bronze|brass|pewter|gunmetal|titanium|chrome|steel|iron|zinc|nickel|aluminum|multi|multicolor|multicolour|rainbow|spectrum|prism|iridescent|holographic|chameleon|color\s*changing|tie\s*dye|ombre|gradient|fade|blend|transition|two\s*tone|three\s*tone|color\s*block|contrasting|complementary|analogous|triadic|split\s*complementary|tetradic|monochromatic|achromatic|neutral|earth\s*tone|jewel\s*tone|pastel|neon|bright|vibrant|bold|rich|deep|dark|light|pale|soft|muted|subdued|toned\s*down|washed\s*out|faded|distressed|vintage|retro|classic|traditional|modern|contemporary|trendy|fashionable|seasonal|spring|summer|fall|autumn|winter|holiday|christmas|valentine|easter|halloween|patriotic|flag|american|british|canadian|australian|french|german|italian|spanish|japanese|chinese|mexican|brazilian|indian|african|tribal|ethnic|metallic|glitter|sparkle|shimmer|shine|gloss|matte|satin|pearl|opal|mother\s*of\s*pearl|abalone|shell|coral|seafoam|ocean|sea|water|sky|cloud|sunset|sunrise|dawn|dusk|twilight|midnight|starlight|moonlight|sunlight|daylight|natural\s*light|artificial\s*light|warm\s*light|cool\s*light|fluorescent|incandescent|led|neon|blacklight|ultraviolet|infrared|x\s*ray|gamma\s*ray|cosmic\s*ray|solar|lunar|stellar|galactic|universal|cosmic|space|alien|futuristic|sci\s*fi|fantasy|magical|mystical|enchanted|fairy\s*tale|princess|queen|king|royal|noble|aristocratic|elegant|sophisticated|refined|luxurious|premium|high\s*end|designer|couture|exclusive|limited\s*edition|rare|unique|one\s*of\s*a\s*kind|custom|bespoke|handmade|artisan|crafted|vintage|antique|retro|classic|timeless|eternal|enduring|lasting|permanent|fade\s*resistant|color\s*fast|washable|machine\s*washable|colorfast|non\s*fading|lightfast|sunfast|weatherproof|outdoor|indoor|interior|exterior|architectural|decorative|ornamental|functional|practical|utilitarian|industrial|commercial|residential|automotive|marine|aviation|aerospace|military|tactical|medical|scientific|laboratory|research|educational|institutional|hospitality|retail|fashion|textile|fabric|clothing|apparel|footwear|accessories|jewelry|cosmetic|beauty|nail|hair|skin|makeup|lipstick|eyeshadow|mascara|foundation|concealer|blush|bronzer|highlighter|contour|primer|setting\s*spray|setting\s*powder|translucent\s*powder|pressed\s*powder|loose\s*powder|compact\s*powder|finishing\s*powder|baking\s*powder|color\s*corrector|color\s*correcting|peach\s*corrector|green\s*corrector|purple\s*corrector|yellow\s*corrector|orange\s*corrector|pink\s*corrector|lavender\s*corrector)\b/i,
            
            // Comprehensive features patterns
            features: /\b(reversible|seamless|seamfree|tagless|tag-free|anti-odor|anti-bacterial|antibacterial|antimicrobial|antifungal|anti-static|antistatic|anti-pill|pill-resistant|anti-wrinkle|wrinkle-free|wrinkle-resistant|crease-resistant|permanent-press|wash-and-wear|easy-care|low-maintenance|care-free|no-iron|iron-free|quick-dry|fast-dry|rapid-dry|instant-dry|moisture-wicking|moisture-absorbing|sweat-wicking|dry-fit|dri-fit|climacool|climalite|coolmax|thermocool|aerocool|ventilated|breathable|air-permeable|mesh-panels|ventilation-zones|cooling|heat-dissipating|temperature-regulating|thermostat|thermal|insulating|heat-retaining|warming|heated|battery-heated|rechargeable|solar-powered|wind-powered|kinetic|energy-harvesting|self-charging|wireless|bluetooth|wifi|nfc|rfid|gps|fitness-tracking|heart-rate-monitoring|step-counting|calorie-tracking|sleep-tracking|activity-tracking|smart|intelligent|connected|iot|internet-of-things|app-controlled|voice-controlled|gesture-controlled|touch-screen|touchpad|buttons|zippers|magnetic|snap|velcro|hook-and-loop|drawstring|elastic|adjustable|customizable|modular|interchangeable|removable|detachable|convertible|transformable|expandable|collapsible|foldable|packable|travel-friendly|compact|lightweight|featherweight|ultra-light|heavy-duty|reinforced|double-stitched|triple-stitched|bartacked|stress-points|high-stress|durability|long-lasting|fade-resistant|shrink-resistant|stretch-resistant|tear-resistant|rip-stop|puncture-resistant|cut-resistant|slash-resistant|knife-resistant|ballistic|bulletproof|stab-proof|spike-resistant|needle-resistant|abrasion-resistant|scuff-resistant|scratch-resistant|chemical-resistant|solvent-resistant|acid-resistant|alkali-resistant|oil-resistant|grease-resistant|stain-resistant|soil-resistant|dirt-repellent|easy-clean|machine-washable|hand-washable|dry-clean-only|spot-clean|wipe-clean|waterproof|water-resistant|water-repellent|hydrophobic|water-shedding|quick-shedding|dwr|durable-water-repellent|windproof|wind-resistant|weatherproof|weather-resistant|storm-proof|all-weather|four-season|three-season|summer|winter|cold-weather|warm-weather|hot-weather|extreme-cold|sub-zero|arctic|alpine|expedition|technical|performance|high-performance|professional|commercial|industrial|military-spec|mil-spec|tactical|outdoor|hiking|climbing|mountaineering|skiing|snowboarding|surfing|diving|sailing|fishing|hunting|shooting|archery|equestrian|motorcycle|automotive|aviation|aerospace|medical|healthcare|laboratory|cleanroom|food-service|hospitality|uniform|workwear|safety|hi-vis|high-visibility|reflective|retro-reflective|3m-scotchlite|prismatic|glass-bead|flame-resistant|fire-retardant|self-extinguishing|arc-rated|arc-flash|electrical|chemical-protection|hazmat|radiation-protection|cut-protection|impact-protection|vibration-dampening|shock-absorbing|energy-absorbing|cushioning|padding|gel-padding|foam-padding|air-padding|memory-foam|viscoelastic|gel-infused|cooling-gel|heating-gel|therapeutic|ergonomic|orthopedic|posture-correcting|spine-aligning|pressure-relieving|circulation-improving|compression|graduated-compression|medical-compression|athletic-compression|recovery-compression|15-20-mmhg|20-30-mmhg|30-40-mmhg|graduated|zoned|targeted|localized|full-body|partial|selective|variable|adjustable-compression|custom-compression|lymphatic-drainage|circulatory|vascular|arterial|venous|capillary|microcirculation|blood-flow|oxygen-delivery|nutrient-delivery|waste-removal|toxin-elimination|detoxification|purification|filtration|air-filtration|water-filtration|particle-filtration|allergen-filtration|pollen-filtration|dust-filtration|bacteria-filtration|virus-filtration|pathogen-filtration|hepa|ulpa|activated-carbon|charcoal|bamboo-charcoal|silver-ion|copper-ion|zinc-ion|titanium-dioxide|ceramic|infrared|far-infrared|negative-ion|anion|cation|ionic|electromagnetic|magnetic|biomagnetic|therapeutic-magnetic|permanent-magnetic|rare-earth-magnetic|neodymium|ferrite|ceramic-magnetic|flexible-magnetic|soft-magnetic|hard-magnetic|shielding|emf-shielding|rf-shielding|electromagnetic-shielding|radiation-shielding|x-ray-shielding|gamma-shielding|neutron-shielding|alpha-shielding|beta-shielding|cosmic-ray-shielding|solar-radiation-shielding|uv-protection|upf|spf|sun-protection|sunblock|sunscreen|photo-protection|light-protection|blue-light-protection|led-protection|screen-protection|digital-eye-strain|computer-vision-syndrome|presbyopia|myopia|hyperopia|astigmatism|progressive|bifocal|trifocal|reading|distance|intermediate|near|far|prescription|non-prescription|plano|zero-power|cosmetic|fashion|designer|luxury|premium|high-end|mid-range|budget|affordable|value|economy|basic|standard|deluxe|professional|commercial|industrial|military|tactical|outdoor|sport|athletic|fitness|training|running|cycling|swimming|hiking|climbing|skiing|snowboarding|surfing|diving|sailing|fishing|hunting|shooting|archery|equestrian|motorcycle|automotive|aviation|aerospace|medical|dental|veterinary|laboratory|research|educational|institutional|hospitality|retail|food-service|restaurant|kitchen|chef|culinary|baking|cooking|grilling|barbecue|smoking|roasting|frying|sauteing|steaming|boiling|poaching|braising|stewing|slow-cooking|pressure-cooking|sous-vide|fermentation|pickling|canning|preserving|freezing|refrigeration|cooling|heating|warming|thermal|insulation|conduction|convection|radiation|evaporation|condensation|sublimation|phase-change|latent-heat|sensible-heat|specific-heat|thermal-mass|thermal-capacity|thermal-conductivity|thermal-resistance|thermal-barrier|thermal-bridge|thermal-break|thermal-envelope|thermal-zone|thermal-comfort|thermal-regulation|thermostat|temperature-control|climate-control|hvac|heating|ventilation|air-conditioning|humidification|dehumidification|air-purification|air-quality|indoor-air-quality|outdoor-air-quality|pollution|particulate|pm2.5|pm10|voc|volatile-organic-compounds|formaldehyde|benzene|toluene|xylene|styrene|methylene-chloride|perchloroethylene|trichloroethylene|radon|asbestos|lead|mercury|cadmium|chromium|arsenic|nickel|cobalt|beryllium|silica|crystalline-silica|respirable-silica|quartz|cristobalite|tridymite|fibrous|non-fibrous|carcinogen|mutagen|teratogen|reproductive-toxin|endocrine-disruptor|neurotoxin|hepatotoxin|nephrotoxin|pulmonary-toxin|dermal-toxin|eye-irritant|respiratory-irritant|skin-sensitizer|corrosive|caustic|flammable|combustible|explosive|oxidizing|reactive|unstable|incompatible|segregation|separation|isolation|containment|encapsulation|enclosure|ventilation|exhaust|extraction|collection|treatment|neutralization|disposal|waste-management|recycling|reuse|reduction|elimination|substitution|engineering-controls|administrative-controls|personal-protective-equipment|ppe|respiratory-protection|eye-protection|face-protection|head-protection|hearing-protection|hand-protection|foot-protection|body-protection|fall-protection|confined-space|hot-work|cold-work|electrical-safety|lockout-tagout|loto|hazardous-energy|machine-guarding|ergonomics|manual-handling|lifting|carrying|pushing|pulling|repetitive-motion|awkward-posture|forceful-exertion|vibration|temperature-extreme|lighting|noise|stress|fatigue|workload|shift-work|night-work|overtime|break|rest|recovery|rehabilitation|return-to-work|disability-management|accommodation|accessibility|universal-design|barrier-free|ada-compliant|wheelchair-accessible|mobility-impaired|visually-impaired|hearing-impaired|cognitively-impaired|developmentally-disabled|intellectually-disabled|physically-disabled|sensory-impaired|multiple-disabilities|inclusive|diversity|equity|inclusion|belonging|cultural-competency|language-access|translation|interpretation|multilingual|bilingual|english-as-second-language|esl|literacy|numeracy|digital-literacy|computer-literacy|internet-literacy|media-literacy|information-literacy|health-literacy|financial-literacy|environmental-literacy|scientific-literacy|technological-literacy|social-literacy|emotional-literacy|cultural-literacy|civic-literacy|global-literacy|sustainability-literacy|climate-literacy|energy-literacy|water-literacy|food-literacy|transportation-literacy|housing-literacy|urban-literacy|rural-literacy|community-literacy|family-literacy|workplace-literacy|lifelong-learning|continuing-education|professional-development|skill-building|capacity-building|empowerment|self-efficacy|self-determination|autonomy|independence|interdependence|collaboration|cooperation|teamwork|partnership|alliance|coalition|network|community|society|culture|tradition|heritage|legacy|history|memory|narrative|story|identity|belonging|connection|relationship|bond|tie|link|bridge|pathway|journey|destination|goal|objective|target|milestone|achievement|success|excellence|quality|value|worth|meaning|purpose|mission|vision|aspiration|dream|hope|faith|belief|trust|confidence|courage|bravery|resilience|perseverance|determination|commitment|dedication|passion|enthusiasm|motivation|inspiration|creativity|innovation|invention|discovery|exploration|adventure|curiosity|wonder|awe|beauty|art|aesthetics|design|style|fashion|trend|movement|revolution|evolution|transformation|change|growth|development|progress|advancement|improvement|enhancement|optimization|efficiency|effectiveness|productivity|performance|results|outcomes|impact|influence|effect|consequence|benefit|advantage|strength|power|force|energy|vitality|health|wellness|wellbeing|fitness|nutrition|diet|exercise|activity|movement|mobility|flexibility|agility|balance|coordination|stability|endurance|stamina|strength|power|speed|quickness|reaction-time|reflexes|hand-eye-coordination|motor-skills|fine-motor|gross-motor|sensory|tactile|visual|auditory|olfactory|gustatory|kinesthetic|proprioceptive|vestibular|cognitive|mental|intellectual|emotional|social|spiritual|psychological|behavioral|neurological|physiological|anatomical|biomechanical|biochemical|biophysical|biomedical|biotechnological|genetic|genomic|proteomic|metabolomic|transcriptomic|epigenetic|microbiome|immunological|inflammatory|oxidative|antioxidant|free-radical|cellular|molecular|atomic|subatomic|quantum|nano|micro|macro|mega|giga|tera|peta|exa|zetta|yotta)\b/i,
            
            // Enhanced collection patterns
            collection: /\b(momentum\s*range|reflect\s*range|forge\s*range|essentials?|basics?|core\s*range|pro\s*range|elite\s*range|premium\s*collection|signature\s*series|active\s*range|performance\s*range|comfort\s*range|luxury\s*line|designer\s*collection|limited\s*edition|exclusive\s*collection|capsule\s*collection|seasonal\s*collection|holiday\s*collection|resort\s*collection|cruise\s*collection|pre\s*fall|fall\s*winter|spring\s*summer|alta\s*moda|haute\s*couture|ready\s*to\s*wear|rtw|prêt\s*à\s*porter|diffusion\s*line|bridge\s*collection|contemporary\s*line|modern\s*collection|classic\s*collection|timeless\s*collection|heritage\s*collection|vintage\s*inspired|retro\s*collection|throwback\s*series|revival\s*collection|anniversary\s*edition|milestone\s*collection|celebration\s*series|commemorative\s*edition|special\s*edition|collaboration|collab|co\s*lab|partnership\s*collection|artist\s*collaboration|designer\s*collaboration|brand\s*collaboration|celebrity\s*collection|influencer\s*line|social\s*media\s*collection|instagram\s*collection|tiktok\s*collection|youtube\s*collection|lifestyle\s*collection|athleisure\s*collection|streetwear\s*collection|urban\s*collection|minimalist\s*collection|maximalist\s*collection|avant\s*garde\s*collection|experimental\s*line|innovative\s*series|cutting\s*edge\s*collection|futuristic\s*line|tech\s*collection|smart\s*collection|connected\s*collection|sustainable\s*collection|eco\s*collection|green\s*line|conscious\s*collection|ethical\s*collection|fair\s*trade\s*collection|organic\s*collection|recycled\s*collection|upcycled\s*collection|circular\s*collection|zero\s*waste\s*collection|carbon\s*neutral\s*collection|climate\s*positive\s*collection|regenerative\s*collection|biodegradable\s*collection|compostable\s*collection|renewable\s*collection|locally\s*sourced\s*collection|artisan\s*collection|handmade\s*collection|craft\s*collection|traditional\s*collection|cultural\s*collection|global\s*collection|international\s*collection|regional\s*collection|local\s*collection|community\s*collection|family\s*collection|kids\s*collection|children\s*collection|baby\s*collection|toddler\s*collection|youth\s*collection|teen\s*collection|junior\s*collection|adult\s*collection|mature\s*collection|senior\s*collection|plus\s*size\s*collection|petite\s*collection|tall\s*collection|big\s*and\s*tall\s*collection|maternity\s*collection|nursing\s*collection|adaptive\s*collection|inclusive\s*collection|accessible\s*collection|universal\s*collection|unisex\s*collection|gender\s*neutral\s*collection|non\s*binary\s*collection|lgbtq\s*collection|pride\s*collection|diversity\s*collection|equality\s*collection|empowerment\s*collection|activism\s*collection|social\s*justice\s*collection|charity\s*collection|fundraising\s*collection|awareness\s*collection|cause\s*collection|nonprofit\s*collection|giving\s*back\s*collection|community\s*support\s*collection|local\s*support\s*collection|small\s*business\s*collection|independent\s*collection|startup\s*collection|emerging\s*designer\s*collection|new\s*talent\s*collection|rising\s*star\s*collection|breakthrough\s*collection|debut\s*collection|first\s*collection|maiden\s*collection|inaugural\s*collection|launch\s*collection|introduction\s*collection|preview\s*collection|sneak\s*peek\s*collection|behind\s*the\s*scenes\s*collection|making\s*of\s*collection|process\s*collection|journey\s*collection|story\s*collection|narrative\s*collection|concept\s*collection|theme\s*collection|inspiration\s*collection|mood\s*collection|aesthetic\s*collection|vibe\s*collection|feeling\s*collection|emotion\s*collection|experience\s*collection|adventure\s*collection|exploration\s*collection|discovery\s*collection|wanderlust\s*collection|travel\s*collection|destination\s*collection|vacation\s*collection|holiday\s*collection|getaway\s*collection|escape\s*collection|retreat\s*collection|sanctuary\s*collection|oasis\s*collection|paradise\s*collection|utopia\s*collection|fantasy\s*collection|dream\s*collection|imagination\s*collection|vision\s*collection|future\s*collection|tomorrow\s*collection|next\s*generation\s*collection|evolution\s*collection|transformation\s*collection|metamorphosis\s*collection|rebirth\s*collection|renewal\s*collection|revival\s*collection|renaissance\s*collection|awakening\s*collection|enlightenment\s*collection|illumination\s*collection|revelation\s*collection|epiphany\s*collection|breakthrough\s*collection|revolution\s*collection|rebellion\s*collection|resistance\s*collection|defiance\s*collection|disruption\s*collection|innovation\s*collection|invention\s*collection|creation\s*collection|genesis\s*collection|origin\s*collection|beginning\s*collection|start\s*collection|launch\s*collection|kickoff\s*collection|premiere\s*collection|opening\s*collection|debut\s*collection|first\s*edition|second\s*edition|third\s*edition|volume\s*one|volume\s*two|volume\s*three|chapter\s*one|chapter\s*two|chapter\s*three|part\s*one|part\s*two|part\s*three|act\s*one|act\s*two|act\s*three|season\s*one|season\s*two|season\s*three|episode\s*one|episode\s*two|episode\s*three|installment\s*one|installment\s*two|installment\s*three|series\s*one|series\s*two|series\s*three|collection\s*one|collection\s*two|collection\s*three|drop\s*one|drop\s*two|drop\s*three|release\s*one|release\s*two|release\s*three|wave\s*one|wave\s*two|wave\s*three|phase\s*one|phase\s*two|phase\s*three|stage\s*one|stage\s*two|stage\s*three|level\s*one|level\s*two|level\s*three|tier\s*one|tier\s*two|tier\s*three|grade\s*one|grade\s*two|grade\s*three|class\s*one|class\s*two|class\s*three|category\s*one|category\s*two|category\s*three|group\s*one|group\s*two|group\s*three|set\s*one|set\s*two|set\s*three|kit\s*one|kit\s*two|kit\s*three|pack\s*one|pack\s*two|pack\s*three|bundle\s*one|bundle\s*two|bundle\s*three|box\s*one|box\s*two|box\s*three|case\s*one|case\s*two|case\s*three|batch\s*one|batch\s*two|batch\s*three|lot\s*one|lot\s*two|lot\s*three|run\s*one|run\s*two|run\s*three|production\s*one|production\s*two|production\s*three|generation\s*one|generation\s*two|generation\s*three|gen\s*one|gen\s*two|gen\s*three|version\s*one|version\s*two|version\s*three|v1|v2|v3|1\.0|2\.0|3\.0|mark\s*one|mark\s*two|mark\s*three|mk1|mk2|mk3|model\s*one|model\s*two|model\s*three|style\s*one|style\s*two|style\s*three|design\s*one|design\s*two|design\s*three)\b/i,
            
            // Enhanced value/price indicators
            value: /\b(sale|clearance|discount|reduced|markdown|was\s*\$|now\s*\$|reg\s*\$|rrp\s*\$|msrp\s*\$|retail\s*\$|\$\d+|\d+\.\d+|2\s*pack|3\s*pack|4\s*pack|5\s*pack|6\s*pack|(\d+)\s*pack|multi-pack|twin\s*pack|value\s*pack|bulk|wholesale|trade|b2b|business|commercial|industrial|institutional|government|military|educational|academic|student|senior|veteran|employee|member|vip|loyalty|rewards|points|cashback|rebate|refund|exchange|return|guarantee|warranty|lifetime|forever|permanent|annual|monthly|weekly|daily|hourly|per\s*piece|per\s*item|per\s*unit|per\s*set|per\s*pair|per\s*dozen|per\s*gross|per\s*case|per\s*box|per\s*bag|per\s*bottle|per\s*can|per\s*jar|per\s*tube|per\s*packet|per\s*sachet|per\s*pouch|per\s*envelope|per\s*wrapper|per\s*container|per\s*package|per\s*parcel|per\s*bundle|per\s*lot|per\s*batch|per\s*order|per\s*purchase|per\s*transaction|per\s*customer|per\s*household|per\s*family|per\s*person|per\s*individual|minimum\s*order|maximum\s*order|minimum\s*purchase|maximum\s*purchase|minimum\s*quantity|maximum\s*quantity|limited\s*quantity|limited\s*stock|limited\s*supply|limited\s*availability|limited\s*time|limited\s*offer|special\s*offer|promotional\s*price|promo\s*price|introductory\s*price|launch\s*price|pre\s*order\s*price|early\s*bird\s*price|flash\s*sale|lightning\s*deal|daily\s*deal|weekly\s*deal|monthly\s*deal|seasonal\s*sale|holiday\s*sale|black\s*friday|cyber\s*monday|boxing\s*day|end\s*of\s*season|end\s*of\s*line|discontinued|closeout|liquidation|going\s*out\s*of\s*business|everything\s*must\s*go|final\s*sale|no\s*returns|as\s*is|damaged|imperfect|second|irregular|factory\s*second|sample|prototype|demo|display|floor\s*model|open\s*box|refurbished|reconditioned|restored|renewed|pre\s*owned|used|vintage|antique|collectible|rare|unique|one\s*of\s*a\s*kind|exclusive|limited\s*edition|numbered|signed|authenticated|certified|genuine|authentic|original|official|licensed|authorized|approved|endorsed|recommended|featured|bestseller|top\s*seller|most\s*popular|trending|viral|hot|new\s*arrival|just\s*in|fresh|latest|newest|recent|current|up\s*to\s*date|modern|contemporary|cutting\s*edge|state\s*of\s*the\s*art|advanced|innovative|revolutionary|groundbreaking|game\s*changing|industry\s*leading|market\s*leading|award\s*winning|prize\s*winning|competition\s*winning|contest\s*winning|championship|champion|winner|victor|first\s*place|gold\s*medal|silver\s*medal|bronze\s*medal|podium|trophy|cup|title|crown|belt|ribbon|badge|certificate|diploma|degree|qualification|accreditation|certification|license|permit|approval|endorsement|recommendation|testimonial|review|rating|score|grade|rank|position|place|status|level|tier|class|category|group|division|section|department|brand|make|model|style|design|pattern|color|colour|size|fit|material|fabric|texture|finish|quality|durability|performance|functionality|features|benefits|advantages|pros|cons|comparison|versus|vs|alternative|substitute|replacement|upgrade|downgrade|entry\s*level|mid\s*range|high\s*end|luxury|premium|deluxe|standard|basic|economy|budget|affordable|cheap|inexpensive|cost\s*effective|value\s*for\s*money|bang\s*for\s*buck|worth\s*it|overpriced|underpriced|fair\s*price|reasonable\s*price|competitive\s*price|market\s*price|street\s*price|going\s*rate|current\s*rate|standard\s*rate|flat\s*rate|fixed\s*rate|variable\s*rate|sliding\s*scale|tiered\s*pricing|volume\s*discount|quantity\s*discount|bulk\s*discount|trade\s*discount|wholesale\s*discount|retail\s*discount|student\s*discount|senior\s*discount|military\s*discount|employee\s*discount|member\s*discount|loyalty\s*discount|frequency\s*discount|repeat\s*customer\s*discount|referral\s*discount|friend\s*discount|family\s*discount|group\s*discount|corporate\s*discount|institutional\s*discount|non\s*profit\s*discount|charity\s*discount|fundraising\s*discount|free\s*shipping|free\s*delivery|free\s*postage|free\s*handling|free\s*processing|free\s*installation|free\s*setup|free\s*assembly|free\s*trial|free\s*sample|free\s*demo|free\s*consultation|free\s*estimate|free\s*quote|no\s*obligation|money\s*back\s*guarantee|satisfaction\s*guarantee|quality\s*guarantee|performance\s*guarantee|results\s*guarantee|success\s*guarantee|happiness\s*guarantee|100%\s*guarantee|full\s*refund|partial\s*refund|store\s*credit|exchange\s*only|final\s*sale|all\s*sales\s*final|no\s*refunds|no\s*exchanges|no\s*returns)\b/i,
            
            // Occasions/Events
            occasion: /\b(wedding|bridal|bride|groom|bridesmaid|groomsmen|bachelor|bachelorette|engagement|anniversary|prom|homecoming|graduation|formal|cocktail|evening|party|gala|ball|dinner|lunch|brunch|breakfast|date\s*night|girls\s*night|boys\s*night|night\s*out|clubbing|dancing|concert|festival|beach|pool|vacation|holiday|travel|work|office|business|professional|interview|meeting|presentation|conference|seminar|workshop|training|church|religious|funeral|memorial|celebration|birthday|baby\s*shower|housewarming|retirement|promotion|award|ceremony|red\s*carpet|photo\s*shoot|modeling|fashion\s*show|runway|editorial|campaign|commercial|advertising|promotional|marketing|launch|debut|premiere|opening|closing|finale|grand\s*opening|soft\s*opening|pre\s*opening|post\s*opening|after\s*party|wrap\s*party|cast\s*party|crew\s*party|staff\s*party|employee\s*party|corporate\s*event|company\s*event|team\s*building|networking|social|casual|everyday|daily|routine|regular|normal|standard|basic|simple|plain|understated|low\s*key|relaxed|comfortable|cozy|homey|intimate|private|personal|individual|solo|alone|independent|self\s*sufficient|autonomous)\b/i,
            
            // Seasonal/Weather patterns
            season: /\b(spring|summer|fall|autumn|winter|seasonal|holiday|christmas|new\s*year|valentine|easter|halloween|thanksgiving|fourth\s*of\s*july|memorial\s*day|labor\s*day|back\s*to\s*school|vacation|travel|beach|pool|resort|cruise|tropical|island|cold\s*weather|warm\s*weather|hot\s*weather|cool\s*weather|mild\s*weather|extreme\s*weather|all\s*weather|four\s*season|three\s*season|transitional|layering|mid\s*season|off\s*season|in\s*season|pre\s*season|post\s*season|end\s*of\s*season|beginning\s*of\s*season|peak\s*season|slow\s*season|busy\s*season|high\s*season|low\s*season|shoulder\s*season|rain|snow|sun|wind|storm|hurricane|tornado|blizzard|hail|sleet|frost|ice|heat|humidity|drought|flood|monsoon|typhoon|cyclone|thunderstorm|lightning|cloudy|overcast|partly\s*cloudy|mostly\s*sunny|clear\s*skies|blue\s*skies|gray\s*skies|stormy\s*skies|dramatic\s*skies|beautiful\s*skies|perfect\s*weather|ideal\s*weather|gorgeous\s*weather|amazing\s*weather|wonderful\s*weather|fantastic\s*weather|incredible\s*weather|awesome\s*weather|perfect\s*day|beautiful\s*day|gorgeous\s*day|amazing\s*day|wonderful\s*day|fantastic\s*day|incredible\s*day|awesome\s*day|sunny\s*day|cloudy\s*day|rainy\s*day|snowy\s*day|windy\s*day|stormy\s*day|hot\s*day|cold\s*day|warm\s*day|cool\s*day|mild\s*day|pleasant\s*day|comfortable\s*day|enjoyable\s*day|delightful\s*day|lovely\s*day|nice\s*day|good\s*day|great\s*day|excellent\s*day|outstanding\s*day|exceptional\s*day|remarkable\s*day|extraordinary\s*day|special\s*day|memorable\s*day|unforgettable\s*day|once\s*in\s*a\s*lifetime\s*day|magical\s*day|enchanting\s*day|captivating\s*day|mesmerizing\s*day|breathtaking\s*day|stunning\s*day|spectacular\s*day|magnificent\s*day|majestic\s*day|grand\s*day|impressive\s*day|awe\s*inspiring\s*day|inspiring\s*day|motivating\s*day|encouraging\s*day|uplifting\s*day|positive\s*day|optimistic\s*day|hopeful\s*day|bright\s*day|cheerful\s*day|joyful\s*day|happy\s*day|blissful\s*day|peaceful\s*day|serene\s*day|tranquil\s*day|calm\s*day|relaxing\s*day|restful\s*day|rejuvenating\s*day|refreshing\s*day|invigorating\s*day|energizing\s*day|revitalizing\s*day|renewing\s*day|restorative\s*day|healing\s*day|therapeutic\s*day|beneficial\s*day|healthy\s*day|wholesome\s*day|nourishing\s*day|nurturing\s*day|caring\s*day|loving\s*day|kind\s*day|gentle\s*day|tender\s*day|soft\s*day|smooth\s*day|easy\s*day|effortless\s*day|simple\s*day|uncomplicated\s*day|straightforward\s*day|clear\s*day|obvious\s*day|evident\s*day|apparent\s*day|visible\s*day|noticeable\s*day|observable\s*day|perceptible\s*day|detectable\s*day|recognizable\s*day|identifiable\s*day|distinguishable\s*day|discernible\s*day|appreciable\s*day|significant\s*day|important\s*day|meaningful\s*day|valuable\s*day|precious\s*day|treasured\s*day|cherished\s*day|beloved\s*day|adored\s*day|worshipped\s*day|revered\s*day|honored\s*day|respected\s*day|admired\s*day|appreciated\s*day|valued\s*day|esteemed\s*day|regarded\s*day|considered\s*day|thought\s*of\s*day|remembered\s*day|recalled\s*day|recollected\s*day|reminisced\s*day|nostalgic\s*day|sentimental\s*day|emotional\s*day|touching\s*day|moving\s*day|stirring\s*day|affecting\s*day|impacting\s*day|influencing\s*day|changing\s*day|transforming\s*day|altering\s*day|modifying\s*day|adjusting\s*day|adapting\s*day|evolving\s*day|developing\s*day|growing\s*day|expanding\s*day|improving\s*day|enhancing\s*day|upgrading\s*day|advancing\s*day|progressing\s*day|moving\s*forward\s*day|going\s*ahead\s*day|pushing\s*forward\s*day|driving\s*forward\s*day|propelling\s*forward\s*day|accelerating\s*day|speeding\s*up\s*day|hastening\s*day|quickening\s*day|rushing\s*day|hurrying\s*day|racing\s*day|flying\s*day|zooming\s*day|dashing\s*day|sprinting\s*day|running\s*day|jogging\s*day|walking\s*day|strolling\s*day|wandering\s*day|roaming\s*day|exploring\s*day|discovering\s*day|finding\s*day|locating\s*day|identifying\s*day|recognizing\s*day|detecting\s*day|noticing\s*day|observing\s*day|seeing\s*day|viewing\s*day|looking\s*day|watching\s*day|monitoring\s*day|tracking\s*day|following\s*day|pursuing\s*day|chasing\s*day|hunting\s*day|seeking\s*day|searching\s*day|investigating\s*day|researching\s*day|studying\s*day|examining\s*day|analyzing\s*day|evaluating\s*day|assessing\s*day|reviewing\s*day|auditing\s*day|inspecting\s*day|checking\s*day|testing\s*day|verifying\s*day|validating\s*day|confirming\s*day|proving\s*day|demonstrating\s*day|showing\s*day|displaying\s*day|exhibiting\s*day|presenting\s*day|revealing\s*day|exposing\s*day|uncovering\s*day|discovering\s*day)\b/i
        };

        // Global variables
        let rawData = [];
        let filteredData = [];
        let currentDateRange = 'all';
        let charts = {
            pattern: null,
            attribute: null,
            time: null
        };
        
        // Function to extract attributes from titles
        function extractAttributes(title) {
            const attributes = {
                title: title,
                brand: null,
                productType: null,
                gender: null,
                size: null,
                activity: null,
                material: null,
                style: null,
                color: null,
                features: null,
                collection: null,
                value: null,
                occasion: null,
                season: null
            };
            
            // Track used positions to avoid overlapping matches
            const usedPositions = [];
            
            function isOverlapping(start, end) {
                return usedPositions.some(used => 
                    (start >= used.start && start <= used.end) || 
                    (end >= used.start && end <= used.end) ||
                    (start <= used.start && end >= used.end)
                );
            }
            
            function addMatch(key, match, title) {
                const start = title.toLowerCase().indexOf(match[0].toLowerCase());
                const end = start + match[0].length - 1;
                
                if (!isOverlapping(start, end)) {
                    attributes[key] = match[0];
                    usedPositions.push({ start, end, key });
                    return true;
                }
                return false;
            }
            
            // Extract brand first (highest priority for overlaps)
            const brandMatch = title.match(patterns.brand);
            if (brandMatch) {
                addMatch('brand', brandMatch, title);
            }
            
            // Extract other attributes in priority order, avoiding overlaps
            const attributeOrder = [
                'productType', 'gender', 'value', 'size', 'activity', 
                'material', 'style', 'color', 'features', 'collection',
                'occasion', 'season'
            ];
            
            for (const key of attributeOrder) {
                const match = title.match(patterns[key]);
                if (match) {
                    // Special handling for cotton/Cotton On conflict
                    if (key === 'material' && match[0].toLowerCase() === 'cotton') {
                        if (attributes.brand && attributes.brand.toLowerCase().includes('cotton on')) {
                            continue;
                        }
                        if (/cotton\s*on/i.test(title)) {
                            if (!attributes.brand) {
                                attributes.brand = 'Cotton On';
                                usedPositions.push({ 
                                    start: title.toLowerCase().indexOf('cotton on'), 
                                    end: title.toLowerCase().indexOf('cotton on') + 8, 
                                    key: 'brand' 
                                });
                            }
                            continue;
                        }
                    }
                    
                    addMatch(key, match, title);
                }
            }
            
            return attributes;
        }

        // Function to get structure pattern from extracted attributes
        function getStructurePattern(title, attributes) {
            const positions = [];
            
            // Get all detected attributes with their actual positions in the title
            for (const [attrType, value] of Object.entries(attributes)) {
                if (value && attrType !== 'title') {
                    const pos = title.toLowerCase().indexOf(value.toLowerCase());
                    if (pos !== -1) {
                        positions.push({ 
                            type: attrType.charAt(0).toUpperCase() + attrType.slice(1), 
                            pos,
                            value
                        });
                    }
                }
            }
            
            // Sort strictly by position in title (left to right)
            positions.sort((a, b) => a.pos - b.pos);
            
            const pattern = positions.map(p => `[${p.type}]`).join(' + ');
            
            return pattern || '[No Pattern]';
        }

        // Export for Node.js if available
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = {
                patterns,
                extractAttributes,
                getStructurePattern
            };
        }
        
        function parseDate(dateStr) {
            // Try different date formats
            const formats = [
                'YYYY-MM-DD',
                'DD/MM/YYYY',
                'MM/DD/YYYY',
                'YYYY/MM/DD',
                'DD-MM-YYYY',
                'MM-DD-YYYY'
            ];
            
            for (const format of formats) {
                const parsed = moment(dateStr, format, true);
                if (parsed.isValid()) {
                    return parsed;
                }
            }
            
            // Try default parsing
            const parsed = moment(dateStr);
            if (parsed.isValid()) {
                return parsed;
            }
            
            return null;
        }
        
        function filterDataByDateRange(data, range) {
            const now = moment();
            let startDate;
            
            switch (range) {
                case 'all':
                    return data;
                case 'year':
                    startDate = now.clone().subtract(1, 'year');
                    break;
                case '6months':
                    startDate = now.clone().subtract(6, 'months');
                    break;
                case '3months':
                    startDate = now.clone().subtract(3, 'months');
                    break;
                case 'month':
                    startDate = now.clone().subtract(1, 'month');
                    break;
                case 'week':
                    startDate = now.clone().subtract(1, 'week');
                    break;
                case 'custom':
                    const customStart = document.getElementById('startDate').value;
                    const customEnd = document.getElementById('endDate').value;
                    if (customStart && customEnd) {
                        startDate = moment(customStart);
                        const endDate = moment(customEnd);
                        return data.filter(item => {
                            if (!item.parsedDate) return false;
                            return item.parsedDate.isBetween(startDate, endDate, null, '[]');
                        });
                    }
                    return data;
                default:
                    return data;
            }
            
            if (startDate) {
                return data.filter(item => {
                    if (!item.parsedDate) return false;
                    return item.parsedDate.isAfter(startDate);
                });
            }
            
            return data;
        }
        
        function updateFilterInfo(filtered, total) {
            const filterInfo = document.getElementById('filterInfo');
            const filterDesc = document.getElementById('filterDescription');
            const dateRangeDisplay = document.getElementById('dateRangeDisplay');
            const filteredCount = document.getElementById('filteredCount');
            const totalCount = document.getElementById('totalCount');
            
            filterInfo.classList.add('active');
            
            let description = '';
            let dateRange = '';
            
            switch (currentDateRange) {
                case 'all':
                    description = 'All time data';
                    dateRange = 'All available dates';
                    break;
                case 'year':
                    description = 'Last 12 months';
                    dateRange = `${moment().subtract(1, 'year').format('MMM DD, YYYY')} - ${moment().format('MMM DD, YYYY')}`;
                    break;
                case '6months':
                    description = 'Last 6 months';
                    dateRange = `${moment().subtract(6, 'months').format('MMM DD, YYYY')} - ${moment().format('MMM DD, YYYY')}`;
                    break;
                case '3months':
                    description = 'Last 3 months';
                    dateRange = `${moment().subtract(3, 'months').format('MMM DD, YYYY')} - ${moment().format('MMM DD, YYYY')}`;
                    break;
                case 'month':
                    description = 'Last 30 days';
                    dateRange = `${moment().subtract(1, 'month').format('MMM DD, YYYY')} - ${moment().format('MMM DD, YYYY')}`;
                    break;
                case 'week':
                    description = 'Last 7 days';
                    dateRange = `${moment().subtract(1, 'week').format('MMM DD, YYYY')} - ${moment().format('MMM DD, YYYY')}`;
                    break;
                case 'custom':
                    const start = document.getElementById('startDate').value;
                    const end = document.getElementById('endDate').value;
                    if (start && end) {
                        description = 'Custom date range';
                        dateRange = `${moment(start).format('MMM DD, YYYY')} - ${moment(end).format('MMM DD, YYYY')}`;
                    }
                    break;
            }
            
            filterDesc.textContent = description;
            dateRangeDisplay.textContent = dateRange;
            filteredCount.textContent = filtered.toLocaleString();
            totalCount.textContent = total.toLocaleString();
        }
        
        function analyzeData(data) {
            const analyzedData = data.map(row => {
                const attrs = extractAttributes(row.title);
                const pattern = getStructurePattern(row.title, attrs);
                
                return {
                    ...row,
                    ...attrs,
                    pattern: pattern
                };
            });
            
            // Calculate pattern statistics
            const patternStats = {};
            const attributeCounts = {
                brand: 0,
                productType: 0,
                gender: 0,
                size: 0,
                activity: 0,
                material: 0,
                style: 0,
                color: 0,
                features: 0,
                occasion: 0, 
                season: 0 
            };
            
            analyzedData.forEach(item => {
                // Pattern stats
                if (!patternStats[item.pattern]) {
                    patternStats[item.pattern] = {
                        count: 0,
                        totalPosition: 0,
                        examples: [],
                        positions: []
                    };
                }
                
                patternStats[item.pattern].count++;
                patternStats[item.pattern].totalPosition += item.position;
                patternStats[item.pattern].positions.push(item.position);
                
                if (patternStats[item.pattern].examples.length < 3) {
                    patternStats[item.pattern].examples.push({
                        title: item.title,
                        position: item.position
                    });
                }
                
                // Attribute counts
                for (const attr of Object.keys(attributeCounts)) {
                    if (item[attr]) attributeCounts[attr]++;
                }
            });
            
            // Calculate averages and sort
            const sortedPatterns = Object.entries(patternStats)
                .map(([pattern, stats]) => ({
                    pattern,
                    count: stats.count,
                    avgPosition: stats.totalPosition / stats.count,
                    minPosition: Math.min(...stats.positions),
                    maxPosition: Math.max(...stats.positions),
                    examples: stats.examples
                }))
                .filter(p => p.count >= 3) // Minimum threshold
                .sort((a, b) => a.avgPosition - b.avgPosition);
            
            return {
                totalProducts: data.length,
                avgPosition: data.reduce((sum, item) => sum + item.position, 0) / data.length,
                patterns: sortedPatterns,
                attributeCounts: attributeCounts,
                analyzedData: analyzedData
            };
        }
        
        function getPerformanceBadge(avgPosition) {
            if (avgPosition <= 10) return '<span class="performance-badge badge-excellent">Excellent</span>';
            if (avgPosition <= 20) return '<span class="performance-badge badge-good">Good</span>';
            if (avgPosition <= 30) return '<span class="performance-badge badge-average">Average</span>';
            return '<span class="performance-badge badge-poor">Poor</span>';
        }
        
        function displayResults(analysis) {
            // Update metrics
            document.getElementById('totalProducts').textContent = analysis.totalProducts.toLocaleString();
            document.getElementById('avgPosition').textContent = analysis.avgPosition.toFixed(1);
            document.getElementById('uniquePatterns').textContent = analysis.patterns.length;
            document.getElementById('bestPattern').textContent = analysis.patterns[0]?.avgPosition.toFixed(1) || '-';
            
            // Create top patterns table
            const tableHtml = `
                <table class="pattern-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Pattern Structure</th>
                            <th>Count</th>
                            <th>Avg Position</th>
                            <th>Performance</th>
                            <th>Example Titles</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${analysis.patterns.slice(0, 10).map((pattern, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td><strong>${pattern.pattern}</strong></td>
                                <td>${pattern.count}</td>
                                <td>${pattern.avgPosition.toFixed(2)}</td>
                                <td>${getPerformanceBadge(pattern.avgPosition)}</td>
                                <td>
                                    ${pattern.examples.map(ex => 
                                        `"${ex.title.length > 50 ? ex.title.substring(0, 50) + '...' : ex.title}" (Pos: ${ex.position})`
                                    ).join('<br>')}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('topPatternsTable').innerHTML = tableHtml;
            
            // Destroy existing charts if they exist
            if (charts.pattern) charts.pattern.destroy();
            if (charts.attribute) charts.attribute.destroy();
            if (charts.time) charts.time.destroy();
            
            // Create pattern performance chart
            const ctx1 = document.getElementById('patternChart').getContext('2d');
            charts.pattern = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: analysis.patterns.slice(0, 10).map(p => p.pattern),
                    datasets: [{
                        label: 'Average Position (Lower is Better)',
                        data: analysis.patterns.slice(0, 10).map(p => p.avgPosition),
                        backgroundColor: 'rgba(102, 126, 234, 0.8)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Top 10 Title Patterns by Average Position',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Average Position'
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
            
            // Create attribute usage chart
            const ctx2 = document.getElementById('attributeChart').getContext('2d');
            charts.attribute = new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(analysis.attributeCounts).map(k => k.charAt(0).toUpperCase() + k.slice(1)),
                    datasets: [{
                        data: Object.values(analysis.attributeCounts),
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)',
                            'rgba(255, 99, 132, 0.8)',
                            'rgba(54, 162, 235, 0.8)',
                            'rgba(255, 206, 86, 0.8)',
                            'rgba(75, 192, 192, 0.8)',
                            'rgba(153, 102, 255, 0.8)',
                            'rgba(255, 159, 64, 0.8)',
                            'rgba(199, 199, 199, 0.8)',
                            'rgba(83, 102, 255, 0.8)',
                            'rgba(255, 102, 132, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Attribute Usage in Titles',
                            font: {
                                size: 16
                            }
                        },
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
            
            // Create time series chart
            const timeData = prepareTimeSeriesData(analysis.analyzedData);
            const ctx3 = document.getElementById('timeChart').getContext('2d');
            charts.time = new Chart(ctx3, {
                type: 'line',
                data: {
                    labels: timeData.labels,
                    datasets: [{
                        label: 'Average Position',
                        data: timeData.avgPositions,
                        borderColor: 'rgba(102, 126, 234, 1)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.3
                    }, {
                        label: 'Product Count',
                        data: timeData.counts,
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.1)',
                        yAxisID: 'y1',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Performance Trends Over Time',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Average Position'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Product Count'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });
            
            // Generate insights
            const insights = [];
            
            if (analysis.patterns[0]) {
                insights.push(`The best performing title structure is <strong>${analysis.patterns[0].pattern}</strong> with an average position of ${analysis.patterns[0].avgPosition.toFixed(1)}`);
            }
            
            // Find most common pattern
            const mostCommon = analysis.patterns.reduce((prev, current) => 
                (prev.count > current.count) ? prev : current
            );
            if (mostCommon) {
                insights.push(`The most frequently used pattern is <strong>${mostCommon.pattern}</strong> appearing ${mostCommon.count} times`);
            }
            
            // Attribute insights
            const mostUsedAttr = Object.entries(analysis.attributeCounts)
                .sort((a, b) => b[1] - a[1])[0];
            insights.push(`<strong>${mostUsedAttr[0].charAt(0).toUpperCase() + mostUsedAttr[0].slice(1)}</strong> is the most commonly used attribute, appearing in ${((mostUsedAttr[1] / analysis.totalProducts) * 100).toFixed(1)}% of titles`);
            
            // Performance insights
            const excellentPatterns = analysis.patterns.filter(p => p.avgPosition <= 10);
            if (excellentPatterns.length > 0) {
                insights.push(`${excellentPatterns.length} title patterns achieve excellent performance (average position ≤ 10)`);
            }
            
            // Date range specific insights
            if (currentDateRange !== 'all') {
                insights.push(`This analysis covers the ${currentDateRange === 'custom' ? 'selected date range' : currentDateRange.replace(/(\d)/, ' $1 ')}`);
            }
            
            document.getElementById('insightsList').innerHTML = insights.map(i => `<li>${i}</li>`).join('');
            
            // Generate recommendations
            const recommendations = [];
            
            if (analysis.patterns[0]) {
                recommendations.push({
                    title: 'Optimal Title Structure',
                    formula: analysis.patterns[0].pattern,
                    description: `This pattern achieves the best average position of ${analysis.patterns[0].avgPosition.toFixed(1)}. Consider restructuring underperforming titles to follow this pattern.`
                });
            }
            
            // Check for brand-first patterns
            const brandFirstPatterns = analysis.patterns.filter(p => p.pattern.startsWith('[Brand]'));
            if (brandFirstPatterns.length > 0 && brandFirstPatterns[0].avgPosition < analysis.avgPosition) {
                recommendations.push({
                    title: 'Lead with Brand',
                    formula: '[Brand] + [Other Attributes]',
                    description: 'Titles that start with the brand name tend to perform better. Consider moving brand names to the beginning of your titles.'
                });
            }
            
            // Check for gender inclusion
            const genderPatterns = analysis.patterns.filter(p => p.pattern.includes('[Gender]'));
            const avgWithGender = genderPatterns.reduce((sum, p) => sum + p.avgPosition, 0) / genderPatterns.length || 0;
            const avgWithoutGender = analysis.patterns.filter(p => !p.pattern.includes('[Gender]'))
                .reduce((sum, p) => sum + p.avgPosition, 0) / analysis.patterns.filter(p => !p.pattern.includes('[Gender]')).length || 0;
            
            if (avgWithGender < avgWithoutGender && genderPatterns.length > 0) {
                recommendations.push({
                    title: 'Include Gender Specification',
                    formula: '[Brand] + [Gender] + [Product Type]',
                    description: 'Titles with gender specification perform better on average. Consider adding gender attributes where relevant.'
                });
            }
            
            const recHtml = recommendations.map(rec => `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #2d3436; margin-bottom: 10px;">${rec.title}</h4>
                    <div class="formula">${rec.formula}</div>
                    <p style="color: #2d3436; line-height: 1.6;">${rec.description}</p>
                </div>
            `).join('');
            
            document.getElementById('recommendations').innerHTML = recHtml;
            
            // Show dashboard
            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }
        
        function prepareTimeSeriesData(analyzedData) {
            // Group by month
            const monthlyData = {};
            
            analyzedData.forEach(item => {
                if (item.parsedDate) {
                    const monthKey = item.parsedDate.format('YYYY-MM');
                    if (!monthlyData[monthKey]) {
                        monthlyData[monthKey] = {
                            positions: [],
                            count: 0
                        };
                    }
                    monthlyData[monthKey].positions.push(item.position);
                    monthlyData[monthKey].count++;
                }
            });
            
            // Sort by date and calculate averages
            const sortedMonths = Object.keys(monthlyData).sort();
            const labels = sortedMonths.map(month => moment(month, 'YYYY-MM').format('MMM YYYY'));
            const avgPositions = sortedMonths.map(month => {
                const positions = monthlyData[month].positions;
                return positions.reduce((sum, pos) => sum + pos, 0) / positions.length;
            });
            const counts = sortedMonths.map(month => monthlyData[month].count);
            
            return { labels, avgPositions, counts };
        }
        
        function processData() {
            filteredData = filterDataByDateRange(rawData, currentDateRange);
            updateFilterInfo(filteredData.length, rawData.length);
            
            if (filteredData.length === 0) {
                alert('No data found in the selected date range.');
                return;
            }
            
            const analysis = analyzeData(filteredData);
            displayResults(analysis);
        }
        
        // Event listeners
        document.querySelectorAll('.date-filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (this.dataset.range === 'custom') {
                    document.getElementById('customDateInputs').style.display = 'flex';
                    return;
                }
                
                document.querySelectorAll('.date-filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentDateRange = this.dataset.range;
                document.getElementById('customDateInputs').style.display = 'none';
                
                if (rawData.length > 0) {
                    processData();
                }
            });
        });
        
        document.getElementById('applyCustomDate').addEventListener('click', function() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (!startDate || !endDate) {
                alert('Please select both start and end dates.');
                return;
            }
            
            if (moment(startDate).isAfter(moment(endDate))) {
                alert('Start date must be before end date.');
                return;
            }
            
            document.querySelectorAll('.date-filter-btn').forEach(b => b.classList.remove('active'));
            document.querySelector('[data-range="custom"]').classList.add('active');
            currentDateRange = 'custom';
            
            if (rawData.length > 0) {
                processData();
            }
        });
        
        // File upload handler
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            document.getElementById('loadingMessage').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            
            Papa.parse(file, {
                header: true,
                dynamicTyping: true,
                skipEmptyLines: true,
                complete: function(results) {
                    if (results.data && results.data.length > 0) {
                        // Parse dates
                        rawData = results.data.map(row => ({
                            ...row,
                            parsedDate: row.Date ? parseDate(row.Date) : null
                        }));
                        
                        // Process with current filter
                        processData();
                    } else {
                        alert('No valid data found in the CSV file.');
                        document.getElementById('loadingMessage').style.display = 'none';
                    }
                },
                error: function(error) {
                    alert('Error parsing CSV: ' + error.message);
                    document.getElementById('loadingMessage').style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
